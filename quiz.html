<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiszki Renesansowe - Quiz</title>
    <link rel="stylesheet" href="style_quiz.css">
</head>
<body>
    <h1>Agatkowe Fiszki - Quiz</h1>
    <a href="index.html" class="nav-back">WrÃ³Ä‡ do Galerii ğŸ </a>

    <!-- Setup View -->
    <div id="setup-container" class="quiz-container">
        <h2>Ustawienia Quizu</h2>
        <div class="form-group">
            <label for="question-count">Liczba pytaÅ„:</label>
            <input type="number" id="question-count" min="1" max="50" value="10">
        </div>
        <div class="form-group">
            <label for="quiz-mode">Co zgadujemy?</label>
            <select id="quiz-mode">
                <option value="author">Autora</option>
                <option value="date">DatÄ™</option>
                <option value="location">LokalizacjÄ™</option>
                <option value="school">SzkoÅ‚Ä™ / TechnikÄ™</option>
            </select>
        </div>
        <button id="start-btn">Rozpocznij Quiz ğŸš€</button>
    </div>

    <!-- Quiz View -->
    <div id="quiz-container" class="quiz-container" style="display: none;">
        <div class="progress">Pytanie <span id="current-q">1</span> / <span id="total-q">10</span></div>
        <div class="image-area">
             <img id="quiz-image" src="" alt="Obraz quizu">
        </div>
        <div id="options-area" class="options-grid">
            <!-- Buttons generated via JS -->
        </div>
        <div id="feedback" class="feedback"></div>
    </div>

    <!-- Result View -->
    <div id="result-container" class="quiz-container" style="display: none;">
        <h2>Koniec Quizu! ğŸ‰</h2>
        <p>TwÃ³j wynik: <span id="score">0</span> / <span id="final-total">0</span></p>
        <button id="restart-btn">Zagraj ponownie</button>
    </div>

    <script>
        // BAZA DANYCH (Sklonowana z program_nauka.html)
        const artworkData = [
            {
                img: "giotto.jpg",
                title: "OpÅ‚akiwanie",
                author: "Giotto",
                date: "1304-1306",
                location: "Kaplica Scrovegnich, Padwa",
                school: "Protorenesans"
            },
            {
                img: "angelico_zwiastowanie.jpg",
                title: "Zwiastowanie",
                author: "Fra Angelico",
                date: "1 poÅ‚ XV w.",
                location: "Klasztor San Marco, Florencja",
                school: "SzkoÅ‚a Florencka"
            },
            {
                img: "masaccio_trojca.jpg",
                title: "TrÃ³jca ÅšwiÄ™ta",
                author: "Masaccio",
                date: "1 poÅ‚ XV w.",
                location: "Santa Maria Novella, Florencja",
                school: "SzkoÅ‚a Florencka"
            },
            {
                img: "masaccio_grosz.jpg",
                title: "Grosz Czynszowy",
                author: "Masaccio",
                date: "1 poÅ‚. XV w.",
                location: "Kaplica Brancaccich, Florencja",
                school: "SzkoÅ‚a Florencka"
            },
            {
                img: "masaccio_adam_ewa.jpg",
                title: "Adam i Ewa (Wygnanie z Raju)",
                author: "Masaccio",
                date: "1 poÅ‚. XV w.",
                location: "Kaplica Brancaccich, Florencja",
                school: "SzkoÅ‚a Florencka"
            },
            {
                img: "uccello_bitwa.jpg",
                title: "Bitwa pod San Romano I",
                author: "Uccello",
                date: "1435-1436",
                location: "Narodowa Galeria, Londyn",
                school: "SzkoÅ‚a Florencka"
            },
            {
                img: "ghirlandaio_starzec.jpg",
                title: "Starzec i chÅ‚opiec",
                author: "Ghirlandaio",
                date: "ok. 1490",
                location: "Luwr, ParyÅ¼",
                school: "SzkoÅ‚a Florencka"
            },
            {
                img: "verrocchio_chrzest.jpg",
                title: "Chrzest Chrystusa",
                author: "Verrocchio i Leonardo da Vinci",
                date: "ok. 1470-1475",
                location: "Galeria Uffizi, Florencja",
                school: "SzkoÅ‚a Florencka"
            },
            {
                img: "botticelli_wiosna.jpg",
                title: "Wiosna (Primavera)",
                author: "Sandro Botticelli",
                date: "1482",
                location: "Galeria Uffizi, Florencja",
                school: "SzkoÅ‚a Florencka"
            },
            {
                img: "botticelli_wenus.jpg",
                title: "Narodziny Wenus",
                author: "Sandro Botticelli",
                date: "ok. 1485",
                location: "Galeria Uffizi, Florencja",
                school: "SzkoÅ‚a Florencka"
            },
            {
                img: "bellini_procesja.jpg",
                title: "Procesja na placu Å›w. Marka",
                author: "Gentile Bellini",
                date: "1496",
                location: "Galleria Akademii, Wenecja",
                school: "SzkoÅ‚a Wenecka"
            },
            {
                img: "bellini_madonna.jpg",
                title: "Madonna z DzieciÄ…tkiem",
                author: "Giovanni Bellini",
                date: "1480-90",
                location: "Accademia Carrara, Bergamo",
                school: "SzkoÅ‚a Wenecka"
            },
            {
                img: "giorgione_burza.jpg",
                title: "Burza",
                author: "Giorgione",
                date: "ok. 1506",
                location: "Galeria Akademii, Wenecja",
                school: "SzkoÅ‚a Wenecka"
            },
            {
                img: "giorgione_koncert.jpg",
                title: "Koncert wiejski",
                author: "Giorgione",
                date: "1509",
                location: "Luwr, ParyÅ¼",
                school: "SzkoÅ‚a Wenecka"
            },
            {
                img: "giorgione_wenus.jpg",
                title: "ÅšpiÄ…ca Wenus",
                author: "Giorgione",
                date: "ok. 1509-1510",
                location: "Galeria w DreÅºnie (Zwinger)",
                school: "SzkoÅ‚a Wenecka"
            },
             {
                img: "tycjan_wenus.jpg",
                title: "Wenus z Urbino",
                author: "Tycjan",
                date: "1538",
                location: "Galeria Uffizi, Florencja",
                school: "SzkoÅ‚a Wenecka"
            },
            {
                img: "tycjan_karol.jpg",
                title: "Karol V po bitwie pod MÃ¼hlberg",
                author: "Tycjan",
                date: "1548",
                location: "Prado, Madryt",
                school: "SzkoÅ‚a Wenecka"
            },
            {
                img: "tycjan_pawel.jpg",
                title: "Portret papieÅ¼a PawÅ‚a III",
                author: "Tycjan",
                date: "1545â€“1546",
                location: "Museo di Capodimonte, Neapol",
                school: "SzkoÅ‚a Wenecka"
            },
            {
                img: "tycjan_koronowanie.jpg",
                title: "Cierniem koronowanie",
                author: "Tycjan",
                date: "1570",
                location: "Stara Pinakoteka, Monachium",
                school: "SzkoÅ‚a Wenecka"
            },
            {
                img: "tycjan_pieta.jpg",
                title: "Pieta",
                author: "Tycjan",
                date: "1570-1576",
                location: "Galeria Akademii, Wenecja",
                school: "SzkoÅ‚a Wenecka"
            },
            {
                img: "mantegna_chrystus.jpg",
                title: "Martwy Chrystus",
                author: "Andrea Mantegna",
                date: "1475â€“1478",
                location: "Pinakoteka Brera, Mediolan",
                school: "SzkoÅ‚a Padewska"
            },
            {
                img: "mantegna_camera.jpg",
                title: "Camera degli Sposi (Fresk)",
                author: "Andrea Mantegna",
                date: "1465-74",
                location: "PaÅ‚ac GonzagÃ³w, Mantua",
                school: "SzkoÅ‚a Padewska"
            },
            {
                img: "piero_chrzest.jpg",
                title: "Chrzest Chrystusa",
                author: "Piero della Francesca",
                date: "lata 50. XV w.",
                location: "National Gallery, Londyn",
                school: "Renesans"
            },
            {
                img: "piero_montefeltro.jpg",
                title: "Portret Federica da Montefeltro",
                author: "Piero della Francesca",
                date: "ok. 1465-70",
                location: "Galeria Uffizi, Florencja",
                school: "Renesans"
            },
            {
                img: "piero_zmartwychwstanie.jpg",
                title: "Zmartwychwstanie",
                author: "Piero della Francesca",
                date: "ok. 1465",
                location: "Museo Civico, Sansepolcro",
                school: "Fresk"
            },
            {
                img: "rafael_slub.jpg",
                title: "ZaÅ›lubiny Marii (Sposalizio)",
                author: "Rafael Santi",
                date: "1504",
                location: "Pinakoteka Brera, Mediolan",
                school: "Renesans"
            },
            {
                img: "rafael_ogrodniczka.jpg",
                title: "PiÄ™kna Ogrodniczka",
                author: "Rafael Santi",
                date: "ok. 1507-1508",
                location: "Luwr, ParyÅ¼",
                school: "Renesans"
            },
             {
                img: "rafael_madonna.jpg",
                title: "Madonna SykstyÅ„ska",
                author: "Rafael Santi",
                date: "ok. 1513â€“1514",
                location: "Galeria Starych MistrzÃ³w, Drezno",
                school: "Renesans"
            },
            {
                img: "rafael_szkola.jpg",
                title: "SzkoÅ‚a AteÅ„ska",
                author: "Rafael Santi",
                date: "1509-1511",
                location: "Stanze WatykaÅ„skie, Rzym",
                school: "Renesans Rzymski"
            },
            {
                img: "michalaniol_stworzenie.jpg",
                title: "Stworzenie Adama",
                author: "MichaÅ‚ AnioÅ‚",
                date: "1511",
                location: "Kaplica SykstyÅ„ska, Rzym",
                school: "Fresk"
            },
            {
                img: "michalaniol_sad.jpg",
                title: "SÄ…d Ostateczny",
                author: "MichaÅ‚ AnioÅ‚",
                date: "1534-1541",
                location: "Kaplica SykstyÅ„ska, Rzym",
                school: "Fresk"
            },
            {
                img: "leonardo_dama.jpg",
                title: "Dama z gronostajem",
                author: "Leonardo da Vinci",
                date: "1483-1490",
                location: "Muzeum Czartoryskich, KrakÃ³w",
                school: "Renesans"
            },
             {
                img: "leonardo_wieczerza.jpg",
                title: "Ostatnia Wieczerza",
                author: "Leonardo da Vinci",
                date: "1495-1498",
                location: "Santa Maria delle Grazie, Mediolan",
                school: "Renesans"
            },
            {
                img: "leonardo_madonna.jpg",
                title: "Madonna w grocie",
                author: "Leonardo da Vinci",
                date: "1483-1490",
                location: "Luwr, ParyÅ¼",
                school: "Renesans"
            },
            {
                img: "leonardo_monalisa.jpg",
                title: "Mona Lisa",
                author: "Leonardo da Vinci",
                date: "1503-1505",
                location: "Luwr, ParyÅ¼",
                school: "Renesans"
            },
             {
                img: "brunelleschi_kopula.jpg",
                title: "KopuÅ‚a Katedry",
                author: "Filippo Brunelleschi",
                date: "1420",
                location: "Florencja",
                school: "Architektura"
            },
            {
                img: "brunelleschi_szpital.jpg",
                title: "Szpital NiewiniÄ…tek",
                author: "Filippo Brunelleschi",
                date: "1420",
                location: "Florencja",
                school: "Architektura"
            },
            {
                img: "brunelleschi_pitti.jpg",
                title: "PaÅ‚ac Pitti",
                author: "Filippo Brunelleschi",
                date: "2 poÅ‚ XV w.",
                location: "Florencja",
                school: "Architektura"
            },
            {
                img: "bramante_tempietto.jpg",
                title: "Tempietto",
                author: "Donato Bramante",
                date: "1502",
                location: "Rzym",
                school: "Architektura"
            },
            {
                img: "palladio_rotonda.jpg",
                title: "Willa Rotonda",
                author: "Andrea Palladio",
                date: "2 poÅ‚. XVI w.",
                location: "Vicenza k. Wenecji",
                school: "Architektura"
            },
            {
                img: "michalaniol_biblioteka.jpg",
                title: "Biblioteka Laurenziana",
                author: "MichaÅ‚ AnioÅ‚",
                date: "1524-1534",
                location: "Florencja",
                school: "Architektura"
            },
            {
                img: "michalaniol_kopula.jpg",
                title: "KopuÅ‚a bazyliki Å›w. Piotra",
                author: "MichaÅ‚ AnioÅ‚",
                date: "1 poÅ‚ XVI w.",
                location: "Rzym",
                school: "Architektura"
            },
            {
                img: "ghiberti_izaak.jpg",
                title: "Ofiara Izaaka (Drzwi Raju)",
                author: "Lorenzo Ghiberti",
                date: "1401",
                location: "Muzeum Bargello, Florencja",
                school: "RzeÅºba (BrÄ…z)"
            },
            {
                img: "donatello_dawid.jpg",
                title: "Dawid (BrÄ…z)",
                author: "Donatello",
                date: "1430",
                location: "Muzeum Bargello, Florencja",
                school: "RzeÅºba (BrÄ…z)"
            },
            {
                img: "verrocchio_dawid.jpg",
                title: "Dawid (BrÄ…z)",
                author: "Verrocchio",
                date: "1475",
                location: "Muzeum Bargello, Florencja",
                school: "RzeÅºba (BrÄ…z)"
            },
            {
                img: "donatello_gattamelata.jpg",
                title: "Pomnik Gattamelaty",
                author: "Donatello",
                date: "1450",
                location: "Padwa",
                school: "RzeÅºba (Konny)"
            },
            {
                img: "verrocchio_colleoni.jpg",
                title: "Pomnik Colleoniego",
                author: "Verrocchio",
                date: "1450",
                location: "Wenecja",
                school: "RzeÅºba (Konny)"
            },
            {
                img: "michalaniol_pieta.jpg",
                title: "PietÃ  WatykaÅ„ska",
                author: "MichaÅ‚ AnioÅ‚",
                date: "1497â€“1500",
                location: "Bazylika Å›w. Piotra, Watykan",
                school: "RzeÅºba (Marmur)"
            },
            {
                img: "michalaniol_dawid.jpg",
                title: "Dawid",
                author: "MichaÅ‚ AnioÅ‚",
                date: "1501-1504",
                location: "Galleria dell'Accademia, Florencja",
                school: "RzeÅºba (Marmur)"
            },
            {
                img: "michalaniol_mojzesz.jpg",
                title: "MojÅ¼esz",
                author: "MichaÅ‚ AnioÅ‚",
                date: "1513â€“1516",
                location: "Bazylika Å›w. Piotra w Okowach, Rzym",
                school: "RzeÅºba (Marmur)"
            },
            {
                img: "michalaniol_wawrzyniec.jpg",
                title: "Nagrobek WawrzyÅ„ca Medyceusza",
                author: "MichaÅ‚ AnioÅ‚",
                date: "1520â€“1535",
                location: "San Lorenzo, Florencja",
                school: "RzeÅºba (Marmur)"
            },
            {
                img: "michalaniol_julian.jpg",
                title: "Nagrobek Juliusza Medyceusza",
                author: "MichaÅ‚ AnioÅ‚",
                date: "1520â€“1535",
                location: "San Lorenzo, Florencja",
                school: "RzeÅºba (Marmur)"
            },
            {
                img: "michalaniol_rondanini.jpg",
                title: "PietÃ  Rondanini",
                author: "MichaÅ‚ AnioÅ‚",
                date: "1564",
                location: "Castello Sforzesco, Mediolan",
                school: "RzeÅºba (Marmur)"
            }
        ];

        // LOGIKA QUIZU
        
        let quizQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let isAnswering = false;

        const setupContainer = document.getElementById('setup-container');
        const quizContainer = document.getElementById('quiz-container');
        const resultContainer = document.getElementById('result-container');

        const quizImage = document.getElementById('quiz-image');
        const optionsArea = document.getElementById('options-area');
        const currentQSpan = document.getElementById('current-q');
        const totalQSpan = document.getElementById('total-q');
        const feedbackDiv = document.getElementById('feedback');

        const scoreSpan = document.getElementById('score');
        const finalTotalSpan = document.getElementById('final-total');

        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');

        startBtn.addEventListener('click', startQuiz);
        restartBtn.addEventListener('click', () => {
            resultContainer.style.display = 'none';
            setupContainer.style.display = 'flex';
        });

        function startQuiz() {
            const countInput = document.getElementById('question-count');
            const modeSelect = document.getElementById('quiz-mode');
            
            let count = parseInt(countInput.value);
            const mode = modeSelect.value;

            if (count > artworkData.length) count = artworkData.length;
            if (count < 1) count = 1;

            quizQuestions = generateQuestions(count, mode);
            currentQuestionIndex = 0;
            score = 0;

            setupContainer.style.display = 'none';
            quizContainer.style.display = 'flex';
            
            renderQuestion();
        }

        function generateQuestions(count, mode) {
            // Pula wszystkich unikalnych wartoÅ›ci dla danego trybu (do losowania bÅ‚Ä™dnych odpowiedzi)
            const allValues = [...new Set(artworkData.map(item => item[mode]))];
            
            // Tasujemy dzieÅ‚a sztuki, Å¼eby wybraÄ‡ pytania
            const shuffledArtworks = shuffleArray([...artworkData]);
            const selectedArtworks = shuffledArtworks.slice(0, count);

            return selectedArtworks.map(artwork => {
                const correctAnswer = artwork[mode];
                let distractors = allValues.filter(val => val !== correctAnswer);
                
                // Losujemy 3 bÅ‚Ä™dne odpowiedzi
                distractors = shuffleArray(distractors).slice(0, 3);
                
                // DokÅ‚adamy poprawnÄ… i tasujemy opcje
                const options = shuffleArray([correctAnswer, ...distractors]);
                
                return {
                    image: artwork.img,
                    correctAnswer: correctAnswer,
                    options: options
                };
            });
        }

        function renderQuestion() {
            isAnswering = true;
            feedbackDiv.innerText = "";
            optionsArea.innerHTML = "";
            
            const q = quizQuestions[currentQuestionIndex];
            
            quizImage.src = q.image;
            currentQSpan.innerText = currentQuestionIndex + 1;
            totalQSpan.innerText = quizQuestions.length;

            q.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.classList.add('option-btn');
                btn.innerText = opt;
                btn.onclick = () => handleAnswer(btn, opt, q.correctAnswer);
                optionsArea.appendChild(btn);
            });
        }

        function handleAnswer(btn, selected, correct) {
            if (!isAnswering) return;
            isAnswering = false;

            const allBtns = optionsArea.querySelectorAll('button');

            if (selected === correct) {
                score++;
                btn.classList.add('correct');
                feedbackDiv.innerText = "Dobrze! ğŸ‘";
                feedbackDiv.style.color = "#28a745";
            } else {
                btn.classList.add('wrong');
                feedbackDiv.innerText = "Å¹le ğŸ˜¢ PrawidÅ‚owa odpowiedÅº to: " + correct;
                feedbackDiv.style.color = "#dc3545";
                
                // PokaÅ¼ poprawnÄ…
                allBtns.forEach(b => {
                    if (b.innerText === correct) b.classList.add('correct');
                });
            }

            // NastÄ™pne pytanie po opÃ³Åºnieniu
            setTimeout(() => {
                currentQuestionIndex++;
                if (currentQuestionIndex < quizQuestions.length) {
                    renderQuestion();
                } else {
                    showResults();
                }
            }, 2000);
        }

        function showResults() {
            quizContainer.style.display = 'none';
            resultContainer.style.display = 'flex';
            scoreSpan.innerText = score;
            finalTotalSpan.innerText = quizQuestions.length;
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

    </script>
</body>
</html>
